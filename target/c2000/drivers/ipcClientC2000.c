/*
 * @file ipcClientC2000.c
 *
 * @brief Client for the inter-processor communication (IPC) library.
 */

//=============================================================================
/*-------------------------------- Includes ---------------------------------*/
//=============================================================================
#include "ipcClientC2000.h"

#include "c2000Config.h"

#include "driverlib.h"
#include "device.h"
//=============================================================================

//=============================================================================
/*-------------------------------- Prototypes -------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
void ipcClientC2000Irq(void *callbackRef);
//-----------------------------------------------------------------------------
//=============================================================================

//=============================================================================
/*-------------------------------- Functions --------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
void ipcClientC2000Initialize(void *param){

    (void)param;
}
//-----------------------------------------------------------------------------
int32_t ipcClientC2000IrqSend(void){

    HWREG(IPC_BASE + IPC_O_SET) = 1UL << C2000_CONFIG_CPU1_CPU2_FLAG;

    return 0;
}
//-----------------------------------------------------------------------------
int32_t ipcClientC2000IrqReceive(uint32_t timeout){

    (void)timeout;

    /* Wait until CPU2 sets the selected flag */
    while( !(HWREG(IPC_BASE + IPC_O_STS) & (1UL << C2000_CONFIG_CPU2_CPU1_FLAG)) );

    /* Acks the IPC flag */
    HWREG(IPC_BASE + IPC_O_ACK) = 1UL << C2000_CONFIG_CPU2_CPU1_FLAG;
    HWREG(IPC_BASE + IPC_O_CLR) = 1UL << C2000_CONFIG_CPU2_CPU1_FLAG;

    return 0;
}
//-----------------------------------------------------------------------------
int32_t ipcClientC2000Lock(uint32_t timeout){

    return 0;
}
//-----------------------------------------------------------------------------
void ipcClientC2000Unlock(void){

}
//-----------------------------------------------------------------------------
//=============================================================================
